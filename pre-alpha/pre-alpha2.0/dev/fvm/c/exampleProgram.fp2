/*
Copyright Â© 2018, Robert Gollagher.
SPDX-License-Identifier: GPL-3.0+

Program:    exampleProgram.fp2
Author :    Robert Gollagher   robert.gollagher@freeputer.net
Created:    20180503
Updated:    20180509+
Version:    pre-alpha-0.0.0.10+ for FVM 2.0

This is an example program using the 'fvm2.c' virtual machine definition.

This source is preprocessed with sed followed by m4 to produce the C source.

Thus to build it do:

  sed -r 's/([z][0-9a-f]+)\.([x][0-9a-f]+)/\1(\2)/g' \
  <exampleProgram.fp2 >exampleProgram.m4 \
  && m4 -d exampleProgram.m4 > exampleProgram.c

Or simply:

  ./build.sh exampleProgram

The resulting 'exampleProgram.c' should never be modified by hand.
It is currently included in 'fvm2.c' which you can then build and run by:

  make good OBJ=fvm2
  time ./fvm2; echo $?

Or to build and run simply:

  ./go.sh exampleProgram

If you wish to examine the output of the C preprocessor you can do:

  gcc -E fvm2.c

==============================================================================
 WARNING: This is pre-alpha software and as such may well be incomplete,
 unstable and unreliable. It is considered to be suitable only for
 experimentation and nothing more.
============================================================================*/
// m4: define(`CONCAT',`$1$2$3')
// m4: define(`as',`define(`thismn',`$1')')
// m4: define(`pub',CONCAT(thismn(),_,$1)/*$2*/) #x0...
// m4: define(`loc',$1/*$2*/) #u0...
// m4: define(`use',`#define $1(xn) $2_ ## xn /*$3*/')
// m4: define(`endmod',`#include "endmod.c"')
// m4: define(`do',`d($1)/*$2*/')
// m4: define(`launch',`jump(m0_x0)/*run.main*/')
/* =========================================================================*/
// ---------------------------------------------------------------------------
launch

// ---------------------------------------------------------------------------
  as(m0)
  module(run)
    unit
      pub(x0,main):
        tron
        noop
        halt
    endun
  endmod
